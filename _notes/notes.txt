=== Developer notes ===

== NOTE: duplicate hero types ==
Training maps which contain duplicate hero types ("core:sylvia") are not
properly (de-)serialized -- only the hero type ID is serialized.

Since gs->allheroes keeps a single record per hero type (a total of 165),
this ID corresponds to the first hero of this type.
The client deserializes it and, as a result, client side's battle info
contains the wrong CGHeroInstance objects. This is not critical (for now) as
some client-side checks like "can cast spell" throw warnings, but everything
ultimately works OK on the server side.

The good new is, CGArmyInstance objects are properly deserialized and
are essentially _the same_ object as the CGHeroInstance object (in the case
of hero-vs-hero battle), meaning they can be (ab)used for inferring the correct
heroes participating in the battle on the client side.


// server
server has gs->allheroes (incl. not on map) - 1 per hero type
  [0] -> (orrin)
  [1] -> (valeska)
  ...
  [80] -> (lorelei)
  ...

Serialization of CGHeroInstance* `h` (e.g. the 7th of the 10 "lorelei" on the map) is:
  1. find index of h->type->id in gs->allheroes (i.e. find 80)
    The data stored inside is the *first* lorelei hero on the map.
  2. send "80" (the type ID for "lorelei")

// client
Deserialization of CGHeroInstance* is:
  1. get gs->allheroes[80] which is the *first* lorelei on the map
  => client sets up battle with this hero, which is a different lorelei
     from the one in the server-side battle
